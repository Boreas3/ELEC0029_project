function [Y0, P_inj, Q_inj, P_gen, Q_gen, Vnom, theta] = crea_matrix()
    global P_load Q_load
    Y0=zeros( 28) ;
    j = sqrt(-1);
    % Contributions of branches to Y
    Y0(  8,  9)=Y0(  8,  9)+  -7.6359196     +   87.049492     *j ;
    Y0(  9,  8)=Y0(  9,  8)+  -7.6359196     +   87.049492     *j ;
    Y0(  8,  8)=Y0(  8,  8)+   7.6359196     +  -87.047493     *j ;
    Y0(  9,  9)=Y0(  9,  9)+   7.6359196     +  -87.047493     *j ;
    Y0(  8,  7)=Y0(  8,  7)+  -3.9699988     +   14.756979     *j ;
    Y0(  7,  8)=Y0(  7,  8)+  -3.9699988     +   14.756979     *j ;
    Y0(  8,  8)=Y0(  8,  8)+   3.9699988     +  -14.745479     *j ;
    Y0(  7,  7)=Y0(  7,  7)+   3.9699988     +  -14.745479     *j ;
    Y0( 12,  9)=Y0( 12,  9)+  -8.3906641     +   38.154797     *j ;
    Y0(  9, 12)=Y0(  9, 12)+  -8.3906641     +   38.154797     *j ;
    Y0( 12, 12)=Y0( 12, 12)+   8.3906641     +  -38.150795     *j ;
    Y0(  9,  9)=Y0(  9,  9)+   8.3906641     +  -38.150795     *j ;
    Y0( 12, 11)=Y0( 12, 11)+  -4.1819124     +   22.477783     *j ;
    Y0( 11, 12)=Y0( 11, 12)+  -4.1819124     +   22.477783     *j ;
    Y0( 12, 12)=Y0( 12, 12)+   4.1819124     +  -22.470783     *j ;
    Y0( 11, 11)=Y0( 11, 11)+   4.1819124     +  -22.470783     *j ;
    Y0( 10, 11)=Y0( 10, 11)+  -6.6067090     +   31.967947     *j ;
    Y0( 11, 10)=Y0( 11, 10)+  -6.6067090     +   31.967947     *j ;
    Y0( 10, 10)=Y0( 10, 10)+   6.6067090     +  -31.962948     *j ;
    Y0( 11, 11)=Y0( 11, 11)+   6.6067090     +  -31.962948     *j ;
    Y0( 10,  9)=Y0( 10,  9)+  -6.6067090     +   31.967947     *j ;
    Y0(  9, 10)=Y0(  9, 10)+  -6.6067090     +   31.967947     *j ;
    Y0( 10, 10)=Y0( 10, 10)+   6.6067090     +  -31.962948     *j ;
    Y0(  9,  9)=Y0(  9,  9)+   6.6067090     +  -31.962948     *j ;
    Y0( 24, 23)=Y0( 24, 23)+  -11.179801     +   118.42163     *j ;
    Y0( 23, 24)=Y0( 23, 24)+  -11.179801     +   118.42163     *j ;
    Y0( 24, 24)=Y0( 24, 24)+   11.179801     +  -118.32303     *j ;
    Y0( 23, 23)=Y0( 23, 23)+   11.179801     +  -118.32303     *j ;
    Y0( 19, 21)=Y0( 19, 21)+  -9.9009905     +   99.009903     *j ;
    Y0( 21, 19)=Y0( 21, 19)+  -9.9009905     +   99.009903     *j ;
    Y0( 19, 19)=Y0( 19, 19)+   9.9009905     +  -98.887901     *j ;
    Y0( 21, 21)=Y0( 21, 21)+   9.9009905     +  -98.887901     *j ;
    Y0( 19, 22)=Y0( 19, 22)+  -9.4080067     +   99.612564     *j ;
    Y0( 22, 19)=Y0( 22, 19)+  -9.4080067     +   99.612564     *j ;
    Y0( 19, 19)=Y0( 19, 19)+   9.4080067     +  -99.490463     *j ;
    Y0( 22, 22)=Y0( 22, 22)+   9.4080067     +  -99.490463     *j ;
    Y0( 19, 17)=Y0( 19, 17)+  -16.524023     +   139.27585     *j ;
    Y0( 17, 19)=Y0( 17, 19)+  -16.524023     +   139.27585     *j ;
    Y0( 19, 19)=Y0( 19, 19)+   16.524023     +  -139.18945     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   16.524023     +  -139.18945     *j ;
    Y0( 19, 20)=Y0( 19, 20)+  -16.524023     +   139.27585     *j ;
    Y0( 20, 19)=Y0( 20, 19)+  -16.524023     +   139.27585     *j ;
    Y0( 19, 19)=Y0( 19, 19)+   16.524023     +  -139.18945     *j ;
    Y0( 20, 20)=Y0( 20, 20)+   16.524023     +  -139.18945     *j ;
    Y0( 21, 23)=Y0( 21, 23)+  -5.8083243     +   61.955467     *j ;
    Y0( 23, 21)=Y0( 23, 21)+  -5.8083243     +   61.955467     *j ;
    Y0( 21, 21)=Y0( 21, 21)+   5.8083243     +  -61.755474     *j ;
    Y0( 23, 23)=Y0( 23, 23)+   5.8083243     +  -61.755474     *j ;
    Y0( 22, 23)=Y0( 22, 23)+  -5.8083243     +   61.955467     *j ;
    Y0( 23, 22)=Y0( 23, 22)+  -5.8083243     +   61.955467     *j ;
    Y0( 22, 22)=Y0( 22, 22)+   5.8083243     +  -61.755474     *j ;
    Y0( 23, 23)=Y0( 23, 23)+   5.8083243     +  -61.755474     *j ;
    Y0( 14, 17)=Y0( 14, 17)+  -24.291470     +   212.74883     *j ;
    Y0( 17, 14)=Y0( 17, 14)+  -24.291470     +   212.74883     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   24.291470     +  -212.69212     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   24.291470     +  -212.69212     *j ;
    Y0( 14, 17)=Y0( 14, 17)+  -17.835026     +   189.88760     *j ;
    Y0( 17, 14)=Y0( 17, 14)+  -17.835026     +   189.88760     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   17.835026     +  -189.82350     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   17.835026     +  -189.82350     *j ;
    Y0( 14, 17)=Y0( 14, 17)+  -17.835026     +   189.88760     *j ;
    Y0( 17, 14)=Y0( 17, 14)+  -17.835026     +   189.88760     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   17.835026     +  -189.82350     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   17.835026     +  -189.82350     *j ;
    Y0( 14, 15)=Y0( 14, 15)+  -65.908653     +   683.23132     *j ;
    Y0( 15, 14)=Y0( 15, 14)+  -65.908653     +   683.23132     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   65.908653     +  -683.21515     *j ;
    Y0( 15, 15)=Y0( 15, 15)+   65.908653     +  -683.21515     *j ;
    Y0( 19, 25)=Y0( 19, 25)+  -9.1899223     +   102.37690     *j ;
    Y0( 25, 19)=Y0( 25, 19)+  -9.1899223     +   102.37690     *j ;
    Y0( 19, 19)=Y0( 19, 19)+   9.1899223     +  -102.26120     *j ;
    Y0( 25, 25)=Y0( 25, 25)+   9.1899223     +  -102.26120     *j ;
    Y0( 17, 16)=Y0( 17, 16)+  -12.138053     +   128.38235     *j ;
    Y0( 16, 17)=Y0( 16, 17)+  -12.138053     +   128.38235     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   12.138053     +  -128.28755     *j ;
    Y0( 16, 16)=Y0( 16, 16)+   12.138053     +  -128.28755     *j ;
    Y0( 18, 17)=Y0( 18, 17)+  -18.982443     +   202.28882     *j ;
    Y0( 17, 18)=Y0( 17, 18)+  -18.982443     +   202.28882     *j ;
    Y0( 18, 18)=Y0( 18, 18)+   18.982443     +  -202.23431     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   18.982443     +  -202.23431     *j ;
    Y0( 18, 17)=Y0( 18, 17)+  -18.982443     +   202.28882     *j ;
    Y0( 17, 18)=Y0( 17, 18)+  -18.982443     +   202.28882     *j ;
    Y0( 18, 18)=Y0( 18, 18)+   18.982443     +  -202.23431     *j ;
    Y0( 17, 17)=Y0( 17, 17)+   18.982443     +  -202.23431     *j ;
    Y0( 26, 28)=Y0( 26, 28)+  -3.1771176     +   31.771177     *j ;
    Y0( 28, 26)=Y0( 28, 26)+  -3.1771176     +   31.771177     *j ;
    Y0( 26, 26)=Y0( 26, 26)+   3.1771176     +  -31.446278     *j ;
    Y0( 28, 28)=Y0( 28, 28)+   3.1771176     +  -31.446278     *j ;
    Y0( 27, 28)=Y0( 27, 28)+  -3.1771176     +   31.771177     *j ;
    Y0( 28, 27)=Y0( 28, 27)+  -3.1771176     +   31.771177     *j ;
    Y0( 27, 27)=Y0( 27, 27)+   3.1771176     +  -31.446278     *j ;
    Y0( 28, 28)=Y0( 28, 28)+   3.1771176     +  -31.446278     *j ;
    Y0( 25, 27)=Y0( 25, 27)+  -4.0528860     +   42.926086     *j ;
    Y0( 27, 25)=Y0( 27, 25)+  -4.0528860     +   42.926086     *j ;
    Y0( 25, 25)=Y0( 25, 25)+   4.0528860     +  -42.781788     *j ;
    Y0( 27, 27)=Y0( 27, 27)+   4.0528860     +  -42.781788     *j ;
    Y0( 24, 26)=Y0( 24, 26)+  -7.0472636     +   74.463120     *j ;
    Y0( 26, 24)=Y0( 26, 24)+  -7.0472636     +   74.463120     *j ;
    Y0( 24, 24)=Y0( 24, 24)+   7.0472636     +  -74.327621     *j ;
    Y0( 26, 26)=Y0( 26, 26)+   7.0472636     +  -74.327621     *j ;
    Y0( 15, 13)=Y0( 15, 13)+ -0.30495131     +   22.205730     *j ;
    Y0( 13, 15)=Y0( 13, 15)+ -0.30495131     +   22.205730     *j ;
    Y0( 15, 15)=Y0( 15, 15)+  0.33239692     +  -24.204247     *j ;
    Y0( 13, 13)=Y0( 13, 13)+  0.27977180     +  -20.372229     *j ;
    Y0( 16,  7)=Y0( 16,  7)+ -0.25874361     +   22.510695     *j ;
    Y0(  7, 16)=Y0(  7, 16)+ -0.25874361     +   22.510695     *j ;
    Y0( 16, 16)=Y0( 16, 16)+  0.27944311     +  -24.311552     *j ;
    Y0(  7,  7)=Y0(  7,  7)+  0.23957741     +  -20.843237     *j ;
    Y0( 20, 11)=Y0( 20, 11)+ -0.25874361     +   22.510695     *j ;
    Y0( 11, 20)=Y0( 11, 20)+ -0.25874361     +   22.510695     *j ;
    Y0( 20, 20)=Y0( 20, 20)+  0.27944311     +  -24.311552     *j ;
    Y0( 11, 11)=Y0( 11, 11)+  0.23957741     +  -20.843237     *j ;
    Y0( 17,  8)=Y0( 17,  8)+ -0.35835353     +   21.138548     *j ;
    Y0(  8, 17)=Y0(  8, 17)+ -0.35835353     +   21.138548     *j ;
    Y0( 17, 17)=Y0( 17, 17)+  0.37985471     +  -22.406860     *j ;
    Y0(  8,  8)=Y0(  8,  8)+  0.33806938     +  -19.942028     *j ;
    Y0( 18, 12)=Y0( 18, 12)+ -0.58811235     +   45.163914     *j ;
    Y0( 12, 18)=Y0( 12, 18)+ -0.58811235     +   45.163914     *j ;
    Y0( 18, 18)=Y0( 18, 18)+  0.61751795     +  -47.422108     *j ;
    Y0( 12, 12)=Y0( 12, 12)+  0.56010705     +  -43.013256     *j ;
    Y0( 19, 10)=Y0( 19, 10)+ -0.60144043     +   47.126564     *j ;
    Y0( 10, 19)=Y0( 10, 19)+ -0.60144043     +   47.126564     *j ;
    Y0( 19, 19)=Y0( 19, 19)+  0.61346924     +  -48.069096     *j ;
    Y0( 10, 10)=Y0( 10, 10)+  0.58964753     +  -46.202518     *j ;
    Y0(  1, 14)=Y0(  1, 14)+  -1.9474163     +   90.597198     *j ;
    Y0( 14,  1)=Y0( 14,  1)+  -1.9474163     +   90.597198     *j ;
    Y0(  1,  1)=Y0(  1,  1)+   2.0079811     +  -93.414772     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   1.8886783     +  -87.864601     *j ;
    Y0(  2, 14)=Y0(  2, 14)+  -1.1949584     +   100.64206     *j ;
    Y0( 14,  2)=Y0( 14,  2)+  -1.1949584     +   100.64206     *j ;
    Y0(  2,  2)=Y0(  2,  2)+   1.2047572     +  -101.46733     *j ;
    Y0( 14, 14)=Y0( 14, 14)+   1.1852394     +  -99.823502     *j ;
    Y0(  3,  7)=Y0(  3,  7)+ -0.69752049     +   36.271061     *j ;
    Y0(  7,  3)=Y0(  7,  3)+ -0.69752049     +   36.271061     *j ;
    Y0(  3,  3)=Y0(  3,  3)+  0.73937166     +  -38.447323     *j ;
    Y0(  7,  7)=Y0(  7,  7)+  0.65803820     +  -34.217983     *j ;
    Y0(  4,  9)=Y0(  4,  9)+ -0.49291438     +   25.631546     *j ;
    Y0(  9,  4)=Y0(  9,  4)+ -0.49291438     +   25.631546     *j ;
    Y0(  4,  4)=Y0(  4,  4)+  0.51756006     +  -26.913122     *j ;
    Y0(  9,  9)=Y0(  9,  9)+  0.46944231     +  -24.410999     *j ;
    Y0(  5, 11)=Y0(  5, 11)+ -0.69752049     +   36.271061     *j ;
    Y0( 11,  5)=Y0( 11,  5)+ -0.69752049     +   36.271061     *j ;
    Y0(  5,  5)=Y0(  5,  5)+  0.73937166     +  -38.447323     *j ;
    Y0( 11, 11)=Y0( 11, 11)+  0.65803820     +  -34.217983     *j ;
    Y0(  6, 23)=Y0(  6, 23)+  -1.4846818     +   77.203453     *j ;
    Y0( 23,  6)=Y0( 23,  6)+  -1.4846818     +   77.203453     *j ;
    Y0(  6,  6)=Y0(  6,  6)+   1.5526803     +  -80.739372     *j ;
    Y0( 23, 23)=Y0( 23, 23)+   1.4196614     +  -73.822395     *j ;

    % Contributions of shunts to Y
    Y0(  7,  7)=Y0(  7,  7)+ j*  0.69999999     ;
    Y0(  8,  8)=Y0(  8,  8)+ j*  0.69999999     ;
    Y0( 10, 10)=Y0( 10, 10)+ j*  0.69999999     ;
    Y0( 11, 11)=Y0( 11, 11)+ j*  0.69999999     ;
    Y0( 13, 13)=Y0( 13, 13)+ j*  0.69999999     ;

    P_inj = zeros(28,1);
    Q_inj = zeros(28,1);
    P_gen = zeros(28,1);
    Q_gen = zeros(28,1);
    Vnom = zeros(28,1);
    theta = zeros(28,1);
    opt(  1).name= 'G1      ' ;
    opt(  1).magv=   1.0300000     ;
    opt(  1).phav= -0.65103864E-01 ;
    opt(  1).injp=   721.17053     ;
    opt(  1).injq=   482.08566     ;
    opt(  2).name= 'G2      ' ;
    opt(  2).magv=   1.0000000     ;
    opt(  2).phav= -0.13832011     ;
    opt(  2).injp=   21.170509     ;
    opt(  2).injq=  -34.487091     ;
    
    opt(  3).name= 'G3      ' ;
    opt(  3).magv=  0.99000001     ;
    opt(  3).phav= -0.71983445E-01 ;
    opt(  3).injp=   399.38126     ;
    opt(  3).injq=   56.176460     ;
    
    opt(  4).name= 'G4      ' ;
    opt(  4).magv=  0.99000001     ;
    opt(  4).phav= -0.13460239     ;
    opt(  4).injp=   250.00000     ;
    opt(  4).injq=   94.553444     ;
    
    opt(  5).name= 'G5      ' ;
    opt(  5).magv=  0.99000001     ;
    opt(  5).phav= -0.91239227E-01 ;
    opt(  5).injp=   375.00000     ;
    opt(  5).injq=   82.446190     ;
    
    opt(  6).name= 'G6      ' ;
    opt(  6).magv=   1.0100000     ;
    opt(  6).phav=  0.58433384E-01 ;
    opt(  6).injp=   800.00000     ;
    opt(  6).injq=   150.33943     ;
    
    opt(  7).name= 'B101    ' ;
    opt(  7).magv=   1.0375649     ;
    opt(  7).phav= -0.17905402     ;
    opt(  7).injp=  -360.00000     ;
    opt(  7).injq=  -155.00000     ;

    opt(  8).name= 'B102    ' ;
    opt(  8).magv=   1.0082851     ;
    opt(  8).phav= -0.23880723     ;
    opt(  8).injp=  -360.00000     ;
    opt(  8).injq=  -160.00000     ;

    opt(  9).name= 'B103    ' ;
    opt(  9).magv=   1.0051240     ;
    opt(  9).phav= -0.23202655     ;
    opt(  9).injp=  -330.00000     ;
    opt(  9).injq=  -150.00000     ;

    opt( 10).name= 'B104    ' ;
    opt( 10).magv=   1.0155743     ;
    opt( 10).phav= -0.20681790     ;
    opt( 10).injp=  -320.00000     ;
    opt( 10).injq=  -145.00000     ;

    opt( 11).name= 'B105    ' ;
    opt( 11).magv=   1.0297013     ;
    opt( 11).phav= -0.19236557     ;
    opt( 11).injp=  -360.00000     ;
    opt( 11).injq=  -170.00000     ;

    opt( 12).name= 'B106    ' ;
    opt( 12).magv=   1.0161029     ;
    opt( 12).phav= -0.22182858     ;
    opt( 12).injp=  -340.00000     ;
    opt( 12).injq=  -125.00000     ;

    opt( 13).name= 'B107    ' ;
    opt( 13).magv=   1.0637757     ;
    opt( 13).phav= -0.28785832     ;
    opt( 13).injp=  -340.00000     ;
    opt( 13).injq=  -130.00000     ;

    opt( 14).name= 'B301    ' ;
    opt( 14).magv=   1.0116036     ;
    opt( 14).phav= -0.14043945     ;
    opt( 14).injp=   0.0000000     ;
    opt( 14).injq=   0.0000000     ;

    opt( 15).name= 'B302    ' ;
    opt( 15).magv=   1.0096785     ;
    opt( 15).phav= -0.14513916     ;
    opt( 15).injp=   0.0000000     ;
    opt( 15).injq=   0.0000000     ;

    opt( 16).name= 'B303    ' ;
    opt( 16).magv=  0.99916961     ;
    opt( 16).phav= -0.15101676     ;
    opt( 16).injp=   0.0000000     ;
    opt( 16).injq=   0.0000000     ;

    opt( 17).name= 'B304    ' ;
    opt( 17).magv=   1.0061659     ;
    opt( 17).phav= -0.14652036     ;
    opt( 17).injp=   0.0000000     ;
    opt( 17).injq=   0.0000000     ;

    opt( 18).name= 'B305    ' ;
    opt( 18).magv=   1.0015885     ;
    opt( 18).phav= -0.15381264     ;
    opt( 18).injp=   0.0000000     ;
    opt( 18).injq=   0.0000000     ;

    opt( 19).name= 'B306    ' ;
    opt( 19).magv=   1.0105876     ;
    opt( 19).phav= -0.13418212     ;
    opt( 19).injp=   0.0000000     ;
    opt( 19).injq=   0.0000000     ;

    opt( 20).name= 'B307    ' ;
    opt( 20).magv=   1.0017408     ;
    opt( 20).phav= -0.14160161     ;
    opt( 20).injp=   0.0000000     ;
    opt( 20).injq=   0.0000000     ;

    opt( 21).name= 'B308    ' ;
    opt( 21).magv=   1.0173150     ;
    opt( 21).phav= -0.11075743     ;
    opt( 21).injp=  -230.00000     ;
    opt( 21).injq=  -70.000000     ;

    opt( 22).name= 'B309    ' ;
    opt( 22).magv=   1.0169720     ;
    opt( 22).phav= -0.11019903     ;
    opt( 22).injp=  -220.00000     ;
    opt( 22).injq=  -75.000000     ;

    opt( 23).name= 'B310    ' ;
    opt( 23).magv=   1.0400448     ;
    opt( 23).phav= -0.39978636E-01 ;
    opt( 23).injp=   0.0000000     ;
    opt( 23).injq=   0.0000000     ;

    opt( 24).name= 'B311    ' ;
    opt( 24).magv=   1.0507298     ;
    opt( 24).phav= -0.28906867E-01 ;
    opt( 24).injp=  -100.00000     ;
    opt( 24).injq=  -30.000002     ;

    opt( 25).name= 'B313    ' ;
    opt( 25).magv=   1.0218857     ;
    opt( 25).phav= -0.12025898     ;
    opt( 25).injp=  -300.00000     ;
    opt( 25).injq=  -70.000000     ;

    opt( 26).name= 'E1      ' ;
    opt( 26).magv=   1.0700001     ;
    opt( 26).phav=   0.0000000     ;
    opt( 26).injp=   304.89325     ;
    opt( 26).injq=   76.937172     ;
    
    opt( 27).name= 'E2      ' ;
    opt( 27).magv=   1.0700001     ;
    opt( 27).phav= -0.26393049E-01 ;
    opt( 27).injp=   414.80240     ;
    opt( 27).injq=   151.51492     ;
    
    opt( 28).name= 'E3      ' ;
    opt( 28).magv=   1.0700001     ;
    opt( 28).phav= -0.13205233E-01 ;
    opt( 28).injp=   0.0000000     ;
    opt( 28).injq=  -73.755745     ;
    
    for i=1:28
        P_inj(i) = opt( i).injp/1000;
        Q_inj(i) = opt( i).injq/1000;
        P_gen(i) = P_inj(i) + P_load(i);
        Q_gen(i) = Q_inj(i) + Q_load(i);
        Vnom(i) = opt( i).magv;
        theta(i) = opt( i).phav*180/pi;
    end
end